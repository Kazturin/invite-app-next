const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Spinner-CW_KfSez.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/vendor-vue-BcvRxASC.js","assets/vendor-BoxHjOd3.js","assets/vendor-BgDCIyLK.css","assets/vendor-vue-C86WLP6Y.css","assets/Stepper-DWSB67si.js","assets/Stepper-D2AdsE-W.css"])))=>i.map(i=>d[i]);
import{_ as l}from"./app-BjUiReq9.js";import{r as i,p as w,o as T,n as C,O as A,q as s,A as u,t as r,y as v,C as _,z as D,m as P,f as p}from"./vendor-vue-BcvRxASC.js";import{I as R}from"./InvitationTemplate-CY-MrtSq.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-BoxHjOd3.js";import"./fabric-C48elvu5.js";const O={class:"container mx-auto"},U={key:0,class:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30"},V={key:0},N={__name:"InvitationEdit",setup(z){const d=_(()=>l(()=>import("./Spinner-CW_KfSez.js"),__vite__mapDeps([0,1,2,3,4,5]))),g=_(()=>l(()=>import("./Stepper-DWSB67si.js"),__vite__mapDeps([6,2,3,4,5,1,7]))),n=C(),f=P(),I=A(),m=i(2),o=i(!1);i(!1);const c=i(null),t=w(()=>n.state.app.invitation);T(async()=>{await n.dispatch("app/getInvitation",I.params.id)});const x=async()=>{await b(),o.value=!1,S({name:"EventUpdate",params:{id:t.value.event_id}})},y=()=>{alert("Шаблон өзгертілмейді")},b=async()=>{o.value=!0;try{const e=await c.value.exportAsImage();await n.commit("app/setImage",e);const a=new FormData;return a.set("content",JSON.stringify(t.value.content)),a.set("template_id",t.value.template_id),a.set("invitation_img",t.value.invitation_img),a.set("bg_img",t.value.bg_img),a.set("inInvitationImage",t.value.inInvitationImage),await n.dispatch("app/saveInvitation",{id:t.value.id,invitation:a}),o.value=!1,Promise.resolve(1)}catch{return n.commit("notify",{type:"error",message:"Қате!"}),o.value=!1,Promise.reject("Error")}},S=e=>{f.replace(e)},E=e=>{n.commit("app/setContent",e)},k=e=>{n.commit("app/setBgImg",e)};return(e,a)=>(p(),s("div",O,[o.value?(p(),s("div",U,[r(v(d))])):u("",!0),r(v(g),{step:m.value,"onUpdate:step":a[0]||(a[0]=h=>m.value=h),backText:e.$t("backStep"),nextText:e.$t("nextStep"),onIncrementStep:x,onDecrementStep:y},{2:D(()=>[t.value&&t.value.template?(p(),s("div",V,[r(R,{ref_key:"capture",ref:c,template:t.value.template,content:t.value.content,edit:!0,bg_img:t.value.bg_img,"onUpdate:content":E,"onUpdate:bg_img":k},null,8,["template","content","bg_img"])])):u("",!0)]),_:1},8,["step","backText","nextText"])]))}},M=B(N,[["__scopeId","data-v-947bbfde"]]);export{M as default};

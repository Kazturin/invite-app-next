const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Alert-TY5PVnD8.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/vendor-vue-BcvRxASC.js","assets/vendor-BoxHjOd3.js","assets/vendor-BgDCIyLK.css","assets/vendor-vue-C86WLP6Y.css","assets/Stepper-DWSB67si.js","assets/Stepper-D2AdsE-W.css"])))=>i.map(i=>d[i]);
import{_ as x}from"./app-BjUiReq9.js";import{r as c,Q as K,o as W,n as X,a as Y,q as u,t as I,z as $,y as g,C as w,m as Z,f as d,b as D,A as p,s as e,H as l,F as P,L as O,G as k,v,R as b,S as ee,I as te}from"./vendor-vue-BcvRxASC.js";import{t as se}from"./quillConfig-DAdV73vn.js";import"./vendor-BoxHjOd3.js";const oe={class:"container mx-auto mb-8"},ie={key:1},ae={class:"space-y-6"},ne={class:"border-b border-gray-900/10 pb-6"},le={class:"text-base font-semibold leading-7 text-gray-900"},re={class:"mt-10"},de={for:"title",class:"text-left block text-sm font-medium leading-6 text-gray-900"},ue={class:"mt-2"},ce={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},pe={key:0,class:"mt-1 text-sm text-red-600"},me={class:"mt-4"},fe={for:"description",class:"text-left block text-sm font-medium leading-6 text-gray-900"},ge={class:"my-2"},ve={class:"mt-4"},_e={for:"photos_link",class:"text-left block text-sm font-medium leading-6 text-gray-900"},be={class:"mt-2"},he={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},ye={class:"mt-4"},xe={class:"mt-2"},we={class:"flex flex-wrap gap-4"},ke=["src"],Ee=["onClick"],Te={key:0,class:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-md flex items-center justify-center cursor-pointer hover:border-indigo-500"},Ie={class:"border-b border-gray-900/10 pb-6"},Se={class:"mt-5"},Ve={class:""},$e={for:"place",class:"text-left block text-sm font-medium leading-6 text-gray-900"},Re={class:"mt-2"},Ce={class:"flex h-8 rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset group focus-within:ring-indigo-600"},Ue={class:"h-full flex justify-center items-center w-8 group-focus-within:border-indigo-600 border-gray-300 border-r"},Ae={key:0,class:"mt-1 text-sm text-red-600"},Fe={class:"mt-4"},Le={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},De={key:0,class:"mt-1 text-sm text-red-600"},Pe={class:"mt-4"},Oe={for:"video_link",class:"text-left block text-sm font-medium leading-6 text-gray-900"},je={class:"mt-2"},qe={class:"flex h-8 items-center rounded-md overflow-hidden shadow-sm ring-1 ring-inset ring-gray-300 group focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},Be={class:"h-full flex justify-center items-center w-8 group-focus-within:border-indigo-600 group-focus-within:border-r-2 border-gray-300 border-r"},Me={class:"mt-4"},Ne={class:"flex space-x-2"},Ge={class:"relative inline-flex cursor-pointer items-center"},ze={key:0,class:"mt-4 flex items-center flex-col sm:flex-row border p-2 rounded-md animate-fade-in-down"},Qe={type:"button",class:"relative overflow-hidden ml-4 w-fit bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},He={class:"mt-4"},Je={for:"date",class:"text-left block text-sm font-medium text-gray-700"},Ke={key:0,class:"mt-1 text-sm text-red-600"},We={class:"mt-6 flex items-center justify-end space-x-2"},Xe={disabled:"",class:"disabled:cursor-not-allowed opacity-25 bg-theme-secondary px-4 py-2 text-white rounded",btnType:"muted"},Ye=["disabled"],Ze={key:0,class:"w-5 h-5 mr-1 rounded-full animate-spin border-2 border-solid border-white border-t-transparent"},et=["disabled"],nt={__name:"EventCreate",setup(tt){const R=w(()=>x(()=>import("./Alert-TY5PVnD8.js"),__vite__mapDeps([0,1,2,3,4,5]))),j=w(()=>x(()=>import("./Stepper-DWSB67si.js"),__vite__mapDeps([6,2,3,4,5,1,7]))),q=w(()=>x(()=>import("./vendor-vue-BcvRxASC.js").then(o=>o.at),__vite__mapDeps([2,3,4,5])).then(o=>o.QuillEditor)),B=w(()=>x(()=>import("./vendor-vue-BcvRxASC.js").then(o=>o.al),__vite__mapDeps([2,3,4,5]))),M=w(()=>x(()=>import("./vendor-vue-BcvRxASC.js").then(o=>o.ai),__vite__mapDeps([2,3,4,5]))),a=X(),E=Z(),C=c(3),T=c(null),r=c({}),U=c(null),A=c(null),F=c(null),m=c([]),h=c([]),i=K({address:null,address_link:"",title:"",description:'<p><span class="ql-font-Mon" style="color: rgb(178, 107, 0);">Тойымыздың қадірлі қонағы болыңыз</span></p>',photos_link:null,place:"",date:"",video_link:null,audio:"/audio/default.mp3",audioFile:null,status:1,created_by:null,audioToggle:!1}),f=c(!1),N=o=>{o.format("font","Mon")},G=()=>{formCompleted.value&&(i.status===1?y({name:"MyEvent",params:{id:E.currentRoute.value.params.id}}):y({name:"LastStep",params:{id:E.currentRoute.value.params.id}}))},z=()=>{y({name:"Step2",params:{id:E.currentRoute.value.params.id}})},y=o=>{E.replace(o)},S=async o=>{if(f.value)return;r.value={};let t=!0;if(i.title||(r.value.title="Той атауын толтырыңыз",t=!1),i.place||(r.value.place="Өтетін жерін толтырыңыз",t=!1),i.address_link||(r.value.address_link="Картаға сілтемені көрсетіңіз",t=!1),i.date||(r.value.date="Басталу уақытын көрсетіңіз",t=!1),!t){window.scrollTo(0,0);return}T.value=null,f.value=!0;const s=new FormData(U.value);s.set("created_by",a.state.user.data.id),i.address_link&&(s.set("address[address]",i.address_link),s.set("address[lat]",0),s.set("address[long]",0)),s.set("description",i.description),i.audioFile&&s.set("audioFile",i.audioFile),i.audioToggle&&s.set("audio",i.audio),h.value.length>0&&h.value.forEach(n=>{s.append("gallery[]",n)}),s.set("status",1),s.set("invitation[content]",JSON.stringify(a.state.app.invitation.content)),s.set("invitation[invitation_img]",a.state.app.invitation.invitation_img),s.set("invitation[envelope_img]",a.state.app.invitation.envelope_img),s.set("invitation[event_id]",null),s.set("invitation[template_id]",a.state.app.invitation.template_id),s.set("invitation[price]",a.state.app.invitation.price),s.set("invitation[bg_img]",a.state.app.invitation.bg_img),s.set("inInvitationImage",a.state.app.invitation.inInvitationImage),console.log(a.state.app.invitation.content);try{const{data:n}=await a.dispatch("app/saveEvent",s);y(o?{name:"LastStep",params:{id:n.id}}:{name:"EventUpdate",params:{id:n.id}}),a.commit("notify",{type:"success",message:"Сәтті сақталды"})}catch(n){console.log(n),T.value=n.response.data.message,window.scroll(0,0)}finally{f.value=!1}},Q=async()=>{const t=F.value.files[0];if(t)try{const s=await L(t);i.audioFile=t,A.value.src=s}catch(s){console.error("Ошибка при чтении файла:",s)}},L=o=>new Promise((t,s)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=_=>s(_),n.readAsDataURL(o)}),H=async o=>{const t=Array.from(o.target.files),s=5-m.value.length,n=t.slice(0,s);for(const _ of n)try{const V=await L(_);m.value.push({url:V,file:_,id:null}),h.value.push(_)}catch(V){console.error("Error reading file:",V)}},J=async o=>{const t=m.value[o];if(t.id)try{await a.dispatch("app/deleteEventImage",t.id),m.value.splice(o,1)}catch(s){console.error("Error deleting image:",s)}else{m.value.splice(o,1);const s=h.value.indexOf(t.file);s>-1&&h.value.splice(s,1)}};return W(()=>{a.state.app.event.data&&(Object.assign(i,a.state.app.event.data),a.state.app.event.data.images&&(m.value=a.state.app.event.data.images.map(o=>({url:"/storage/"+o.path,id:o.id,file:null}))),a.state.app.event.data.address&&(i.address_link=a.state.app.event.data.address.address))}),Y(()=>{i.value={}}),(o,t)=>(d(),u("div",oe,[I(g(j),{step:C.value,"onUpdate:step":t[10]||(t[10]=s=>C.value=s),backText:o.$t("backStep"),nextText:o.$t("nextStep"),doneText:o.$t("lastStep"),onIncrementStep:G,onDecrementStep:z,onComplete:t[11]||(t[11]=s=>S(!0))},{3:$(()=>[T.value?(d(),D(g(R),{key:0,class:"md:w-2/3 mx-auto text-sm"},{default:$(()=>[e("div",null,l(T.value),1)]),_:1})):p("",!0),r.value?(d(),u("div",ie,[(d(!0),u(P,null,O(r.value,s=>(d(),D(g(R),{class:"md:w-2/3 mb-2 mx-auto text-sm"},{default:$(()=>[e("div",null,l(s),1)]),_:2},1024))),256))])):p("",!0),e("form",{ref_key:"form",ref:U,class:"border border-gray-200 rounded-lg mt-10 w-full md:w-2/3 mx-auto p-4"},[e("div",ae,[e("div",ne,[e("h2",le,l(o.$t("event.information")),1),e("div",re,[e("div",null,[e("label",de,[k(l(o.$t("event.title"))+" ",1),t[12]||(t[12]=e("span",{class:"text-red-500"},"*",-1))]),e("div",ue,[e("div",ce,[v(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.title=s),type:"text",name:"title",id:"title",required:"",autocomplete:"title",class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"Әлібек пен Аружанның тойы"},null,512),[[b,i.title]])]),r.value.title?(d(),u("p",pe,l(r.value.title),1)):p("",!0)])]),e("div",me,[e("label",fe,l(o.$t("event.more_info"))+":",1),e("div",ge,[I(g(q),{theme:"snow",content:i.description,"onUpdate:content":t[1]||(t[1]=s=>i.description=s),contentType:"html",toolbar:g(se),class:"min-h-[8rem] max-h-[8rem] overflow-y-auto",placeholder:"Тойымыздың қадірлі қонағы болыңыздар",onReady:N},null,8,["content","toolbar"])])]),e("div",ve,[e("label",_e,l(o.$t("event.photos_link")),1),e("div",be,[e("div",he,[v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.photos_link=s),type:"text",name:"photos_link",id:"photos_link",class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"https://www.instagram.com/explore/search/keyword/?q=%23aidanauzatu"},null,512),[[b,i.photos_link]])])])]),e("div",ye,[t[14]||(t[14]=e("label",{class:"text-left block text-sm font-medium leading-6 text-gray-900"}," Фотогалерея (макс. 5 фото) ",-1)),e("div",xe,[e("div",we,[(d(!0),u(P,null,O(m.value,(s,n)=>(d(),u("div",{key:n,class:"relative w-24 h-24"},[e("img",{src:s.url,class:"w-full h-full object-cover rounded-md"},null,8,ke),e("button",{type:"button",onClick:_=>J(n),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 w-6 h-6 flex items-center justify-center text-xs"}," x ",8,Ee)]))),128)),m.value.length<5?(d(),u("label",Te,[t[13]||(t[13]=e("span",{class:"text-2xl text-gray-400"},"+",-1)),e("input",{type:"file",multiple:"",accept:"image/*",onChange:H,class:"hidden"},null,32)])):p("",!0)])])])])]),e("div",Ie,[e("div",Se,[e("div",Ve,[e("label",$e,[k(l(o.$t("event.restaurant_name"))+" ",1),t[15]||(t[15]=e("span",{class:"text-red-500"},"*",-1))]),e("div",Re,[e("div",Ce,[e("div",Ue,[I(g(M),{class:"w-5 text-gray-600"})]),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.place=s),type:"text",name:"place",id:"place",required:"",placeholder:"Ресторан 'Алтын орман'",class:"block flex-1 border-0 bg-transparent py-1.5 pl-2 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"},null,512),[[b,i.place]])]),r.value.place?(d(),u("p",Ae,l(r.value.place),1)):p("",!0)])]),e("div",Fe,[t[16]||(t[16]=e("div",{class:"text-left font-medium text-gray-900 text-sm leading-6"},[k("Өтетін жері картасына сілтеме "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Le,[v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.address_link=s),type:"text",name:"address_link",id:"address_link",required:"",class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"https://go.2gis.com/..."},null,512),[[b,i.address_link]])]),r.value.address_link?(d(),u("p",De,l(r.value.address_link),1)):p("",!0)]),e("div",Pe,[e("label",Oe,"Видео(youtube "+l(o.$t("link"))+")",1),e("div",je,[e("div",qe,[e("div",Be,[I(g(B),{class:"w-5 text-gray-600"})]),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>i.video_link=s),type:"text",name:"video_link",id:"video_link",class:"block flex-1 border-0 bg-transparent py-1.5 pl-2 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"},null,512),[[b,i.video_link]])])])]),e("div",Me,[e("div",Ne,[e("label",Ge,[v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.audioToggle=s),id:"switch",type:"checkbox",class:"peer sr-only"},null,512),[[ee,i.audioToggle]]),t[17]||(t[17]=e("label",{for:"switch",class:"hidden"},null,-1)),t[18]||(t[18]=e("div",{class:"peer h-6 w-11 rounded-full border bg-slate-200 after:absolute after:left-[2px] after:top-0.5 after:h-5 after:w-5 after:rounded-full after:border after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:ring-green-300"},null,-1))]),t[19]||(t[19]=e("span",null,"Музыка",-1))]),i.audioToggle?(d(),u("div",ze,[e("audio",{class:"mb-2 sm:mb-0 w-full",controls:"",ref_key:"audioPlayer",ref:A,src:"/storage/audio/default.mp3"},null,512),e("button",Qe,[e("input",{ref_key:"audioFileInput",ref:F,type:"file",accept:".mp3",onChange:Q,class:"absolute left-0 top-0 right-0 bottom-0 opacity-0 cursor-pointer"},null,544),t[20]||(t[20]=k(" Өзгерту ",-1))])])):p("",!0)]),e("div",He,[e("div",null,[e("label",Je,[k(l(o.$t("event.start_time"))+" ",1),t[21]||(t[21]=e("span",{class:"text-red-500"},"*",-1))]),v(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>i.date=s),type:"datetime-local",name:"date",required:"",id:"date",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[b,i.date]]),r.value.date?(d(),u("p",Ke,l(r.value.date),1)):p("",!0)])])])])]),e("div",We,[e("button",Xe,l(o.$t("button.preview")),1),e("button",{disabled:f.value,type:"button",onClick:t[8]||(t[8]=s=>S(!1)),class:te(["bg-theme-secondary px-4 py-2 text-white rounded flex items-center",{"cursor-not-allowed":f.value}])},[f.value?(d(),u("span",Ze)):p("",!0),e("span",null,l(o.$t("button.save")),1)],10,Ye),e("button",{type:"button",onClick:t[9]||(t[9]=s=>S(!0)),disabled:f.value,class:"bg-theme-primary px-4 py-2 text-white rounded"},l(o.$t("button.completion")),9,et)])],512)]),_:1},8,["step","backText","nextText","doneText"])]))}};export{nt as default};

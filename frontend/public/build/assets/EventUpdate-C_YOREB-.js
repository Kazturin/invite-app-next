const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Stepper-DWSB67si.js","assets/vendor-vue-BcvRxASC.js","assets/vendor-BoxHjOd3.js","assets/vendor-BgDCIyLK.css","assets/vendor-vue-C86WLP6Y.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/Stepper-D2AdsE-W.css","assets/Alert-TY5PVnD8.js"])))=>i.map(i=>d[i]);
import{_ as y}from"./app-BjUiReq9.js";import{r as n,p as F,o as Z,n as ee,O as te,m as se,w as oe,q as p,t as _,z as P,y as f,C as x,e as le,f as i,b as ae,A as V,G as U,H as r,s as t,v as m,R as g,I as B,F as ne,L as re,S as ie}from"./vendor-vue-BcvRxASC.js";import{t as de}from"./quillConfig-DAdV73vn.js";import"./vendor-BoxHjOd3.js";const ue={class:"container mx-auto"},ce={class:"space-y-6"},pe={class:"border-b border-gray-900/10 pb-8"},me={class:"text-base font-semibold leading-7 text-gray-900"},ve={class:"mt-10"},fe={for:"title",class:"text-left block text-sm font-medium leading-6 text-gray-900"},ge={class:"mt-2"},he={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},be={class:"mt-4"},ye={for:"description",class:"text-left block text-sm font-medium leading-6 text-gray-900"},_e={class:"mt-4"},xe={for:"photos_link",class:"text-left block text-sm font-medium leading-6 text-gray-900"},we={class:"mt-2"},ke={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},Ee={class:"mt-4"},Te={class:"mt-2"},$e={class:"flex flex-wrap gap-4"},Le=["src"],Ce=["onClick"],Ve={key:0,class:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-md flex items-center justify-center cursor-pointer hover:border-indigo-500"},Ae={class:"border-b border-gray-900/10 pb-6"},Ie={class:"mt-5"},De={class:""},Fe={for:"place",class:"text-left block text-sm font-medium leading-6 text-gray-900"},Pe={class:"mt-2"},Ue={class:"flex h-8 rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},Re={class:"h-full flex justify-center items-center w-8 group-focus-within:border-indigo-600 border-gray-300 border-r"},Se={class:"mt-4"},qe={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},Oe={class:"mt-4"},Be={for:"video_link",class:"text-left block text-sm font-medium leading-6 text-gray-900"},je={class:"mt-2"},Me={class:"flex h-8 items-center rounded-md overflow-hidden shadow-sm ring-1 ring-inset ring-gray-300 group focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600"},ze={class:"h-full flex justify-center items-center w-8 group-focus-within:border-indigo-600 group-focus-within:border-r-2 border-gray-300 border-r"},Ge={class:"mt-4"},Ne={class:"flex space-x-2"},He={class:"relative inline-flex cursor-pointer items-center"},Qe={key:0,class:"mt-4 flex items-center flex-col sm:flex-row border p-2 rounded-md animate-fade-in-down"},Je=["src"],Ke={type:"button",class:"relative overflow-hidden ml-4 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},We={class:"mt-4"},Xe={for:"date",class:"text-left block text-sm font-medium text-gray-700"},Ye={class:"mt-6 flex items-center justify-end gap-x-2"},Ze=["disabled"],et={key:0,class:"w-5 h-5 mr-1 rounded-full animate-spin border-2 border-solid border-white border-t-transparent"},tt=["disabled"],st={key:2,class:"absolute right-1/2 bottom-1/2 transform translate-x-1/2 translate-y-1/2"},it={__name:"EventUpdate",setup(ot){const j=x(()=>y(()=>import("./Stepper-DWSB67si.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),M=x(()=>y(()=>import("./vendor-vue-BcvRxASC.js").then(s=>s.al),__vite__mapDeps([1,2,3,4]))),z=x(()=>y(()=>import("./vendor-vue-BcvRxASC.js").then(s=>s.ai),__vite__mapDeps([1,2,3,4]))),G=x(()=>y(()=>import("./Alert-TY5PVnD8.js"),__vite__mapDeps([7,5,1,2,3,4]))),N=x(()=>y(()=>import("./vendor-vue-BcvRxASC.js").then(s=>s.at),__vite__mapDeps([1,2,3,4])).then(s=>s.QuillEditor)),d=ee(),w=se(),k=te(),R=n(3),H=n(!1),A=n(null),v=n(!1),h=n(null),S=n(null),E=n(null),q=n(null),u=n([]),b=n([]),T=n(""),o=F(()=>d.state.app.event.data);F(()=>d.state.app.invitation);const $=F(()=>d.state.app.event.saveLoading),I=n(null),L=n(!1),Q=s=>{s.stopPropagation(),L.value=!L.value};Z(async()=>{try{(await d.dispatch("app/getEventEdit",k.params.id)).order.status===2&&w.push({name:"Forbidden"}),H.value=!0,o.value&&o.value.audio!==null&&(v.value=!0),o.value&&o.value.images&&(u.value=o.value.images.map(e=>({url:"/storage/"+e.path,id:e.id,file:null}))),o.value&&o.value.address&&(T.value=o.value.address.address)}catch(s){console.error("Error fetching event details:",s)}if(I.value){const s=I.value.getToolbar(),e=document.createElement("button");e.setAttribute("type","button"),e.innerHTML='<svg class="w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M24 22h-24v-20h24v20zm-1-19h-22v18h22v-18zm-4 7h-1v-3.241l-11.241 11.241h3.241v1h-5v-5h1v3.241l11.241-11.241h-3.241v-1h5v5z"/></svg>',e.classList.add("ql-fullscreen-btn"),e.addEventListener("click",Q),s.appendChild(e)}});const J=()=>{w.push({name:"InvitationEdit",params:{id:o.value.invitation.id}})},K=s=>{s?o.value.order.status===0?w.push({name:"LastStep",params:{id:k.params.id}}):w.push({name:"MyEvent",params:{id:k.params.id}}):d.dispatch("app/getEventEdit",k.params.id)},D=async s=>{const e=new FormData(S.value);e.append("id",o.value.id),e.append("address[address]",T.value),e.append("address[lat]",0),e.append("address[long]",0),e.append("status",o.value.status),e.append("description",o.value.description),v.value&&!h.value&&!o.value.audio&&e.append("audio","/audio/default.mp3"),h.value&&e.append("audioFile",h.value),b.value.length>0&&b.value.forEach(a=>{e.append("gallery[]",a)});try{await d.dispatch("app/updateEvent",{id:o.value.id,event:e}),K(s),d.commit("notify",{type:"success",message:"Сәтті сақталды"})}catch(a){A.value=a.response.data.message,console.error("Error saving event:",a.response.data.message),window.scroll(0,0)}},W=async()=>{const s=q.value.files[0];if(s)try{const e=await O(s);h.value=s,E.value.src=e}catch(e){console.error("Error reading audio file:",e)}},O=s=>new Promise((e,a)=>{const l=new FileReader;l.onload=()=>e(l.result),l.onerror=c=>a(c),l.readAsDataURL(s)});oe(v,s=>{s===!0&&!h.value&&E.value&&(E.value.src="/storage/audio/default.mp3")});const X=async s=>{const e=Array.from(s.target.files),a=5-u.value.length,l=e.slice(0,a);for(const c of l)try{const C=await O(c);u.value.push({url:C,file:c,id:null}),b.value.push(c)}catch(C){console.error("Error reading file:",C)}},Y=async s=>{const e=u.value[s];if(e.id)try{await d.dispatch("app/deleteEventImage",e.id),u.value.splice(s,1)}catch(a){console.error("Error deleting image:",a)}else{u.value.splice(s,1);const a=b.value.indexOf(e.file);a>-1&&b.value.splice(a,1)}};return(s,e)=>{const a=le("router-link");return i(),p("div",ue,[_(f(j),{step:R.value,"onUpdate:step":e[10]||(e[10]=l=>R.value=l),backText:s.$t("backStep"),doneText:s.$t("button.completion"),donetText:s.$t("lastStep"),onDecrementStep:J,onComplete:e[11]||(e[11]=l=>D(!0))},{3:P(()=>[A.value?(i(),ae(f(G),{key:0,class:"flex-col items-stretch text-sm"},{default:P(()=>[U(r(A.value),1)]),_:1})):V("",!0),o.value?(i(),p("form",{key:1,ref_key:"form",ref:S,class:"border border-gray-200 rounded-lg mt-10 w-full md:w-2/3 mx-auto p-4"},[t("div",ce,[t("div",pe,[t("h2",me,r(s.$t("event.information")),1),t("div",ve,[t("div",null,[t("label",fe,r(s.$t("event.title")),1),t("div",ge,[t("div",he,[m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.title=l),type:"text",name:"title",id:"title",required:"",autocomplete:"title",class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"},null,512),[[g,o.value.title]])])])]),t("div",be,[t("label",ye,r(s.$t("event.additional_information")),1),t("div",{class:B(["my-2",{"ql-fullscreen":L.value}])},[_(f(N),{ref_key:"quillEditor",ref:I,theme:"snow",content:o.value.description,"onUpdate:content":e[1]||(e[1]=l=>o.value.description=l),contentType:"html",toolbar:f(de),name:"description",class:B(["min-h-[8rem] overflow-y-auto",{"max-h-[8rem]":!L.value}]),placeholder:"Тойымыздың қадірлі қонағы болыңыздар"},null,8,["content","toolbar","class"])],2)]),t("div",_e,[t("label",xe,r(s.$t("event.photos_link")),1),t("div",we,[t("div",ke,[m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.photos_link=l),type:"text",name:"photos_link",id:"photos_link",autocomplete:"photos_link",class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"},null,512),[[g,o.value.photos_link]])])])]),t("div",Ee,[e[13]||(e[13]=t("label",{class:"text-left block text-sm font-medium leading-6 text-gray-900"}," Фотогалерея (макс. 5 фото) ",-1)),t("div",Te,[t("div",$e,[(i(!0),p(ne,null,re(u.value,(l,c)=>(i(),p("div",{key:c,class:"relative w-24 h-24"},[t("img",{src:l.url,class:"w-full h-full object-cover rounded-md"},null,8,Le),t("button",{type:"button",onClick:C=>Y(c),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 w-6 h-6 flex items-center justify-center text-xs"}," x ",8,Ce)]))),128)),u.value.length<5?(i(),p("label",Ve,[e[12]||(e[12]=t("span",{class:"text-2xl text-gray-400"},"+",-1)),t("input",{type:"file",multiple:"",accept:"image/*",onChange:X,class:"hidden"},null,32)])):V("",!0)])])])])]),t("div",Ae,[t("div",Ie,[t("div",De,[t("label",Fe,r(s.$t("event.restaurant_name")),1),t("div",Pe,[t("div",Ue,[t("div",Re,[_(f(z),{class:"w-5 text-gray-600"})]),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.place=l),type:"text",name:"place",id:"place",required:"",class:"block flex-1 border-0 bg-transparent py-1.5 pl-2 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"},null,512),[[g,o.value.place]])])])]),t("div",Se,[e[14]||(e[14]=t("div",{class:"text-left font-medium text-gray-900 text-sm leading-6"},"Өтетін жері картасына сілтеме",-1)),t("div",qe,[m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>T.value=l),type:"text",name:"address_link",id:"address_link",class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"https://go.2gis.com/..."},null,512),[[g,T.value]])])]),t("div",Oe,[t("label",Be,"Видео(youtube "+r(s.$t("link"))+")",1),t("div",je,[t("div",Me,[t("div",ze,[_(f(M),{class:"w-5 text-gray-600"})]),m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.video_link=l),type:"text",name:"video_link",id:"video_link",class:"block flex-1 border-0 bg-transparent py-1.5 pl-2 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"},null,512),[[g,o.value.video_link]])])])]),t("div",Ge,[t("div",Ne,[t("label",He,[m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>v.value=l),id:"switch",type:"checkbox",class:"peer sr-only"},null,512),[[ie,v.value]]),e[15]||(e[15]=t("label",{for:"switch",class:"hidden"},null,-1)),e[16]||(e[16]=t("div",{class:"peer h-6 w-11 rounded-full border bg-slate-200 after:absolute after:left-[2px] after:top-0.5 after:h-5 after:w-5 after:rounded-full after:border after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:ring-green-300"},null,-1))]),e[17]||(e[17]=t("span",null,"Музыка",-1))]),v.value?(i(),p("div",Qe,[t("audio",{class:"mb-2 sm:mb-0 w-full",controls:"",ref_key:"audioPlayer",ref:E,src:o.value.audio??"/storage/audio/default.mp3"},null,8,Je),t("button",Ke,[t("input",{ref_key:"audioFileInput",ref:q,type:"file",onChange:W,class:"absolute left-0 top-0 right-0 bottom-0 opacity-0 cursor-pointer"},null,544),e[18]||(e[18]=U(" Өзгерту ",-1))])])):V("",!0)]),t("div",We,[t("div",null,[t("label",Xe,r(s.$t("event.start_time")),1),m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.date=l),type:"datetime-local",name:"date",required:"",id:"date",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[g,o.value.date]])])])])])]),t("div",Ye,[_(a,{disabled:$.value,class:"disabled:cursor-not-allowed bg-theme-secondary px-4 py-2 text-white rounded",btnType:"muted",to:{name:"Preview",params:{id:s.$route.params.id}}},{default:P(()=>[U(r(s.$t("button.preview")),1)]),_:1},8,["disabled","to"]),t("button",{onClick:e[8]||(e[8]=l=>D(!1)),type:"button",disabled:$.value,class:"bg-theme-secondary px-4 py-2 text-white rounded flex items-center disabled:cursor-not-allowed"},[$.value?(i(),p("span",et)):V("",!0),t("span",null,r(s.$t("button.save")),1)],8,Ze),t("button",{disabled:$.value,type:"button",onClick:e[9]||(e[9]=l=>D(!0)),class:"bg-theme-primary px-4 py-2 text-white rounded disabled:cursor-not-allowed"},r(s.$t("button.completion")),9,tt)])],512)):(i(),p("div",st,[...e[19]||(e[19]=[t("div",{class:"border-t-transparent border-solid animate-spin rounded-full border-blue-500 border-2 w-12 h-12"},null,-1)])]))]),_:1},8,["step","backText","doneText","donetText"])])}}};export{it as default};

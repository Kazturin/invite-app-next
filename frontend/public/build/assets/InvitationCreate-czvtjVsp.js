import{r as p,p as S,o as k,n as y,O as I,q as o,A as b,t as r,z as h,m as C,f as n,b as T}from"./vendor-vue-BcvRxASC.js";import B from"./Stepper-DWSB67si.js";import u from"./Spinner-CW_KfSez.js";import{I as R}from"./InvitationTemplate-CY-MrtSq.js";import"./vendor-BoxHjOd3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./fabric-C48elvu5.js";const z={class:"container mx-auto"},U={key:0,class:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30"},w={key:0},A={key:1,class:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30"},D={__name:"InvitationCreate",setup(N){const t=y(),c=C(),m=I(),d=p(!1),i=p(2),s=p(null),a=S(()=>t.state.app.template.data),f=e=>{t.commit("app/setContent",e)},v=e=>{t.commit("app/setBgImg",e)},_=async()=>{if(!s.value)return;const e=await s.value.exportAsImage();if(console.log(e),e)t.commit("app/setImage",e);else{console.error("Не удалось экспортировать изображение.");return}c.replace({name:"Step3",params:{id:m.params.id}})},g=()=>{c.replace({name:"Step1"})};return k(()=>{t.dispatch("app/getTemplate",m.params.id).then(e=>{e.content&&t.commit("app/setContent",e.content)})}),(e,l)=>(n(),o("div",z,[d.value?(n(),o("div",U,[r(u)])):b("",!0),r(B,{step:i.value,"onUpdate:step":l[0]||(l[0]=x=>i.value=x),backText:e.$t("backStep"),nextText:e.$t("nextStep"),onIncrementStep:_,onDecrementStep:g},{2:h(()=>[a.value&&a.value.content?(n(),o("div",w,[(n(),T(R,{key:a.value.id,ref_key:"captureRef",ref:s,template:a.value,content:a.value.content,bg_img:null,"onUpdate:content":f,"onUpdate:bg_img":v},null,8,["template","content"]))])):(n(),o("div",A,[r(u)]))]),_:1},8,["step","backText","nextText"])]))}};export{D as default};
